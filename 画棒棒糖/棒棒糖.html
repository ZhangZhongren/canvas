<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>棒棒糖</title>
		<style type="text/css">
			#canvas{
				border: 1px solid red;
			}
		</style>
	</head>
	<body>
		<canvas id="canvas" width="500" height="500"></canvas>
	</body>
	<script>
		var canvas = document.getElementById("canvas");
		var context = canvas.getContext("2d");
		context.translate(250,250);
		var r = 0;
		var num = 0;
		var everyPercent = Math.PI/90;
		function draw(color){
			context.beginPath();
			context.fillStyle = color;
			context.arc(r,0,20,0,Math.PI*2,false);
			context.fill();
		}
		var color = rundColor()
		function act(){
			r+=0.3;
			if(r>150){
				r=150;
				num++;
			}
			context.rotate(everyPercent);
			draw(color);
			res = window.requestAnimationFrame(act);	
			if( num > 180){
				window.cancelAnimationFrame(res);
				drawbang();
			}
		}
		act();
		//随机数函数
		function rundNumber(min,max){
			return parseInt(Math.random()*(max-min) + min);
		}
		function rundColor(){
			return "rgb("+rundNumber(0,256) +","+ rundNumber(0,256) +","+ rundNumber(0,256) + ")";
		}
		function drawbang(){
			context.beginPath();
			context.lineWidth = 40 ;
			context.moveTo(-120,120);
			context.strokeStyle = rundColor();
			context.lineTo(-250,250);
			context.stroke();
		}
	</script>
</html>
